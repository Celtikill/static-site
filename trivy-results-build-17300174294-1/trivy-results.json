{
  "SchemaVersion": 2,
  "CreatedAt": "2025-08-28T15:15:17.251466154Z",
  "ArtifactName": "terraform",
  "ArtifactType": "filesystem",
  "Metadata": {
    "ImageConfig": {
      "architecture": "",
      "created": "0001-01-01T00:00:00Z",
      "os": "",
      "rootfs": {
        "type": "",
        "diff_ids": null
      },
      "config": {}
    }
  },
  "Results": [
    {
      "Target": ".",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 2,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "bootstrap",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 2,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "bootstrap/backend-infrastructure.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 12,
        "Failures": 1,
        "Exceptions": 1
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0017",
          "AVDID": "AVD-AWS-0017",
          "Title": "CloudWatch log groups should be encrypted using CMK",
          "Description": "CloudWatch log groups are encrypted by default, however, to get the full benefit of controlling key rotation and other KMS aspects a KMS CMK should be used.",
          "Message": "Log group is not encrypted.",
          "Query": "data..",
          "Resolution": "Enable CMK encryption of CloudWatch Log Groups",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0017",
          "References": [
            "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0017"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_cloudwatch_log_group.s3_access_logs",
            "Provider": "AWS",
            "Service": "cloudwatch",
            "StartLine": 151,
            "EndLine": 161,
            "Code": {
              "Lines": [
                {
                  "Number": 151,
                  "Content": "resource \"aws_cloudwatch_log_group\" \"s3_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_cloudwatch_log_group\"\u001b[0m \u001b[38;5;37m\"s3_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "  name              = \"/aws/s3/terraform-state-access\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m              = \u001b[38;5;37m\"/aws/s3/terraform-state-access\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "  retention_in_days = 30",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mretention_in_days\u001b[0m = \u001b[38;5;37m30",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "    Name        = \"S3 Terraform State Access Logs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"S3 Terraform State Access Logs\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "    Environment = \"shared\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"shared\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 158,
                  "Content": "    Purpose     = \"audit-logging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"audit-logging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 159,
                  "Content": "    ManagedBy   = \"opentofu\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mManagedBy\u001b[0m   = \u001b[38;5;37m\"opentofu\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 160,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 3,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "management-account",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 2,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "modules/account-factory/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 10,
        "Failures": 0,
        "Exceptions": 1
      }
    },
    {
      "Target": "modules/cloudfront/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 4,
        "Failures": 0,
        "Exceptions": 1
      }
    },
    {
      "Target": "modules/monitoring/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 3,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "modules/s3/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 26,
        "Failures": 0,
        "Exceptions": 1
      }
    },
    {
      "Target": "modules/security-baseline-cloudtrail",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 2,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "modules/security-baseline-cloudtrail/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 14,
        "Failures": 0,
        "Exceptions": 3
      }
    },
    {
      "Target": "modules/security-baseline-config",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 2,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "modules/security-baseline-config/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 9,
        "Failures": 0,
        "Exceptions": 1
      }
    },
    {
      "Target": "modules/security-baseline-guardduty",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 1,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "modules/security-baseline-securityhub",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 1,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "modules/waf/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 1,
        "Failures": 0,
        "Exceptions": 0
      }
    }
  ]
}
