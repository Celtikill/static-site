{
  "SchemaVersion": 2,
  "CreatedAt": "2025-07-11T10:51:03.488377-04:00",
  "ArtifactName": ".",
  "ArtifactType": "filesystem",
  "Metadata": {
    "ImageConfig": {
      "architecture": "",
      "created": "0001-01-01T00:00:00Z",
      "os": "",
      "rootfs": {
        "type": "",
        "diff_ids": null
      },
      "config": {}
    }
  },
  "Results": [
    {
      "Target": ".",
      "Class": "config",
      "Type": "terraformplan-snapshot",
      "MisconfSummary": {
        "Successes": 54,
        "Failures": 0
      }
    },
    {
      "Target": "modules/cloudfront/main.tf",
      "Class": "config",
      "Type": "terraformplan-snapshot",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 1
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Plan Snapshot Security Check",
          "ID": "AVD-AWS-0010",
          "AVDID": "AVD-AWS-0010",
          "Title": "Cloudfront distribution should have Access Logging configured",
          "Description": "You should configure CloudFront Access Logging to create log files that contain detailed information about every user request that CloudFront receives\n",
          "Message": "Distribution does not have logging enabled",
          "Namespace": "builtin.aws.cloudfront.aws0010",
          "Query": "data.builtin.aws.cloudfront.aws0010.deny",
          "Resolution": "Enable logging for CloudFront distributions",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0010",
          "References": [
            "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/AccessLogs.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0010"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.cloudfront",
            "Provider": "AWS",
            "Service": "cloudfront",
            "StartLine": 32,
            "EndLine": 128,
            "Code": {
              "Lines": [
                {
                  "Number": 32,
                  "Content": "resource \"aws_cloudfront_distribution\" \"website\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_cloudfront_distribution\"\u001b[0m \u001b[38;5;37m\"website\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  comment             = var.distribution_comment",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcomment\u001b[0m             = \u001b[38;5;33mvar\u001b[0m.distribution_comment",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "  default_root_object = var.default_root_object",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mdefault_root_object\u001b[0m = \u001b[38;5;33mvar\u001b[0m.default_root_object",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  enabled             = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245menabled\u001b[0m             = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  http_version        = \"http2and3\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mhttp_version\u001b[0m        = \u001b[38;5;37m\"http2and3\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "  is_ipv6_enabled     = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mis_ipv6_enabled\u001b[0m     = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  price_class         = var.price_class",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprice_class\u001b[0m         = \u001b[38;5;33mvar\u001b[0m.price_class",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  web_acl_id          = var.web_acl_id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mweb_acl_id\u001b[0m          = \u001b[38;5;33mvar\u001b[0m.web_acl_id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;239m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 41,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.cloudfront",
                "Filename": "main.tf",
                "Location": {
                  "StartLine": 118,
                  "EndLine": 138
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "modules/s3/main.tf",
      "Class": "config",
      "Type": "terraformplan-snapshot"
    }
  ]
}
