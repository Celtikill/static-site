{
  "SchemaVersion": 2,
  "CreatedAt": "2025-08-28T14:59:37.413857437Z",
  "ArtifactName": "terraform",
  "ArtifactType": "filesystem",
  "Metadata": {
    "ImageConfig": {
      "architecture": "",
      "created": "0001-01-01T00:00:00Z",
      "os": "",
      "rootfs": {
        "type": "",
        "diff_ids": null
      },
      "config": {}
    }
  },
  "Results": [
    {
      "Target": ".",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 2,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "bootstrap",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 2,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "bootstrap/backend-infrastructure.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 12,
        "Failures": 2,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0017",
          "AVDID": "AVD-AWS-0017",
          "Title": "CloudWatch log groups should be encrypted using CMK",
          "Description": "CloudWatch log groups are encrypted by default, however, to get the full benefit of controlling key rotation and other KMS aspects a KMS CMK should be used.",
          "Message": "Log group is not encrypted.",
          "Query": "data..",
          "Resolution": "Enable CMK encryption of CloudWatch Log Groups",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0017",
          "References": [
            "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0017"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_cloudwatch_log_group.s3_access_logs",
            "Provider": "AWS",
            "Service": "cloudwatch",
            "StartLine": 151,
            "EndLine": 161,
            "Code": {
              "Lines": [
                {
                  "Number": 151,
                  "Content": "resource \"aws_cloudwatch_log_group\" \"s3_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_cloudwatch_log_group\"\u001b[0m \u001b[38;5;37m\"s3_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "  name              = \"/aws/s3/terraform-state-access\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m              = \u001b[38;5;37m\"/aws/s3/terraform-state-access\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "  retention_in_days = 30",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mretention_in_days\u001b[0m = \u001b[38;5;37m30",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "    Name        = \"S3 Terraform State Access Logs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"S3 Terraform State Access Logs\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "    Environment = \"shared\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"shared\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 158,
                  "Content": "    Purpose     = \"audit-logging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"audit-logging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 159,
                  "Content": "    ManagedBy   = \"opentofu\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mManagedBy\u001b[0m   = \u001b[38;5;37m\"opentofu\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 160,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0089",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0089",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0089"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.terraform_state",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 12,
            "EndLine": 21,
            "Code": {
              "Lines": [
                {
                  "Number": 12,
                  "Content": "resource \"aws_s3_bucket\" \"terraform_state\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"terraform_state\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "  bucket = \"static-site-terraform-state-${data.aws_caller_identity.current.account_id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"static-site-terraform-state-\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.aws_caller_identity.current.account_id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "    Name        = \"Terraform State Bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m        = \u001b[38;5;37m\"Terraform State Bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "    Environment = \"shared\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"shared\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "    Purpose     = \"terraform-state\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"terraform-state\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "    ManagedBy   = \"opentofu\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mManagedBy\u001b[0m   = \u001b[38;5;37m\"opentofu\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 3,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "management-account",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 2,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "modules/account-factory/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 10,
        "Failures": 1,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0089",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0089",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0089"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.security_accounts",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 102,
            "EndLine": 114,
            "Code": {
              "Lines": [
                {
                  "Number": 102,
                  "Content": "resource \"aws_s3_bucket\" \"terraform_state\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"terraform_state\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 103,
                  "Content": "  for_each = var.accounts",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfor_each\u001b[0m = \u001b[38;5;33mvar\u001b[0m.accounts",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 104,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 105,
                  "Content": "  bucket = \"${var.project_name}-tf-state-${each.key}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-tf-state-\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33meach\u001b[0m.key\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 106,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 107,
                  "Content": "  tags = merge(var.common_tags, {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.common_tags, {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 108,
                  "Content": "    Name    = \"${var.project_name}-tf-state-${each.key}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m    = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-tf-state-\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33meach\u001b[0m.key\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "    Account = each.key",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mAccount\u001b[0m = \u001b[38;5;33meach\u001b[0m.key",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 110,
                  "Content": "    Purpose = \"terraform-state\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mPurpose\u001b[0m = \u001b[38;5;37m\"terraform-state\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 111,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.security_accounts",
                "Filename": "management-account/main.tf",
                "Location": {
                  "StartLine": 78,
                  "EndLine": 97
                }
              }
            ]
          }
        }
      ]
    },
    {
      "Target": "modules/cloudfront/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 4,
        "Failures": 1,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0010",
          "AVDID": "AVD-AWS-0010",
          "Title": "Cloudfront distribution should have Access Logging configured",
          "Description": "You should configure CloudFront Access Logging to create log files that contain detailed information about every user request that CloudFront receives",
          "Message": "Distribution does not have logging enabled.",
          "Query": "data..",
          "Resolution": "Enable logging for CloudFront distributions",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0010",
          "References": [
            "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/AccessLogs.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0010"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.cloudfront",
            "Provider": "AWS",
            "Service": "cloudfront",
            "StartLine": 36,
            "EndLine": 135,
            "Code": {
              "Lines": [
                {
                  "Number": 36,
                  "Content": "resource \"aws_cloudfront_distribution\" \"website\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_cloudfront_distribution\"\u001b[0m \u001b[38;5;37m\"website\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "  comment             = var.distribution_comment",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcomment\u001b[0m             = \u001b[38;5;33mvar\u001b[0m.distribution_comment",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  default_root_object = var.default_root_object",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mdefault_root_object\u001b[0m = \u001b[38;5;33mvar\u001b[0m.default_root_object",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  enabled             = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245menabled\u001b[0m             = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  http_version        = \"http2and3\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mhttp_version\u001b[0m        = \u001b[38;5;37m\"http2and3\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  is_ipv6_enabled     = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mis_ipv6_enabled\u001b[0m     = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  price_class         = var.price_class",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprice_class\u001b[0m         = \u001b[38;5;33mvar\u001b[0m.price_class",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  web_acl_id          = var.web_acl_id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mweb_acl_id\u001b[0m          = \u001b[38;5;33mvar\u001b[0m.web_acl_id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;239m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 45,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.cloudfront",
                "Filename": "main.tf",
                "Location": {
                  "StartLine": 167,
                  "EndLine": 190
                }
              }
            ]
          }
        }
      ]
    },
    {
      "Target": "modules/monitoring/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 3,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "modules/s3/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 26,
        "Failures": 1,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0089",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0089",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0089"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.s3",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 90,
            "EndLine": 100,
            "Code": {
              "Lines": [
                {
                  "Number": 90,
                  "Content": "resource \"aws_s3_bucket\" \"replica\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"replica\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "  count    = var.enable_replication ? 1 : 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.enable_replication \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "  provider = aws.replica",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m\u001b[38;5;33m  provider\u001b[0m \u001b[38;5;245m=\u001b[0m aws.replica",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  bucket   = length(\"${var.bucket_name}-replica\") \u003e 63 ? \"${substr(var.bucket_name, 0, 55)}-${substr(md5(var.bucket_name), 0, 7)}\" : \"${var.bucket_name}-replica\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m   =\u001b[38;5;33m length\u001b[0m(\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.bucket_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-replica\"\u001b[0m) \u001b[38;5;245m\u003e\u001b[0m \u001b[38;5;37m63\u001b[0m \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33msubstr\u001b[0m(\u001b[38;5;33mvar\u001b[0m.bucket_name, \u001b[38;5;37m0\u001b[0m, \u001b[38;5;37m55\u001b[0m)\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33msubstr\u001b[0m(\u001b[38;5;33mmd5\u001b[0m(\u001b[38;5;33mvar\u001b[0m.bucket_name), \u001b[38;5;37m0\u001b[0m, \u001b[38;5;37m7\u001b[0m)\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.bucket_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-replica\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "  tags = merge(var.common_tags, {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.common_tags, {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "    Name    = \"${var.bucket_name}-replica\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m    = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.bucket_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-replica\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "    Purpose = \"Cross-Region Replication\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m = \u001b[38;5;37m\"Cross-Region Replication\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "    Module  = \"s3\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mModule\u001b[0m  = \u001b[38;5;37m\"s3\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 99,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.s3",
                "Filename": "main.tf",
                "Location": {
                  "StartLine": 115,
                  "EndLine": 131
                }
              }
            ]
          }
        }
      ]
    },
    {
      "Target": "modules/security-baseline-cloudtrail",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 2,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "modules/security-baseline-cloudtrail/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 15,
        "Failures": 2,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0057",
          "AVDID": "AVD-AWS-0057",
          "Title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
          "Description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
          "Message": "IAM policy document uses sensitive action 'logs:CreateLogStream' on wildcarded resource '390fc596-2ebe-4382-a100-469f7ef850b8'",
          "Query": "data..",
          "Resolution": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0057",
          "References": [
            "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0057"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_iam_role_policy.cloudtrail_cloudwatch[0]",
            "Provider": "AWS",
            "Service": "iam",
            "StartLine": 193,
            "EndLine": 193,
            "Code": {
              "Lines": [
                {
                  "Number": 186,
                  "Content": "resource \"aws_iam_role_policy\" \"cloudtrail_cloudwatch\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_iam_role_policy\"\u001b[0m \u001b[38;5;37m\"cloudtrail_cloudwatch\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 187,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 193,
                  "Content": "    Version = \"2012-10-17\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mVersion\u001b[0m = \u001b[38;5;37m\"2012-10-17\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 207,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 208,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_iam_role_policy.cloudtrail_cloudwatch[0].policy",
                "Filename": "modules/security-baseline-cloudtrail/main.tf",
                "Location": {
                  "StartLine": 193,
                  "EndLine": 193
                }
              },
              {
                "Resource": "aws_iam_role_policy.cloudtrail_cloudwatch[0].policy",
                "Filename": "modules/security-baseline-cloudtrail/main.tf",
                "Location": {
                  "StartLine": 192,
                  "EndLine": 207
                }
              },
              {
                "Resource": "aws_iam_role_policy.cloudtrail_cloudwatch[0]",
                "Filename": "modules/security-baseline-cloudtrail/main.tf",
                "Location": {
                  "StartLine": 186,
                  "EndLine": 208
                }
              }
            ]
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0089",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0089",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0089"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.cloudtrail[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 19,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "resource \"aws_s3_bucket\" \"cloudtrail\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"cloudtrail\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  count = var.create_cloudtrail_bucket ? 1 : 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;33mvar\u001b[0m.create_cloudtrail_bucket \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  bucket = \"${var.bucket_prefix}-cloudtrail-${var.account_name}-${data.aws_region.current.name}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.bucket_prefix\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-cloudtrail-\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.account_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.aws_region.current.name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  tags = merge(var.common_tags, {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.common_tags, {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "    Name    = \"cloudtrail-logs-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m    = \u001b[38;5;37m\"cloudtrail-logs-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "    Purpose = \"audit-logging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m = \u001b[38;5;37m\"audit-logging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "    Account = var.account_name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mAccount\u001b[0m = \u001b[38;5;33mvar\u001b[0m.account_name",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 28,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "modules/security-baseline-config",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 2,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "modules/security-baseline-config/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 9,
        "Failures": 1,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0089",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0089",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0089"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.config[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 28,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"config\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"config\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  count = var.create_config_bucket ? 1 : 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;33mvar\u001b[0m.create_config_bucket \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  bucket = \"${var.bucket_prefix}-config-${var.account_name}-${data.aws_region.current.name}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.bucket_prefix\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-config-\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.account_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.aws_region.current.name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  tags = merge(var.common_tags, {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m =\u001b[38;5;33m merge\u001b[0m(\u001b[38;5;33mvar\u001b[0m.common_tags, {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "    Name    = \"config-delivery-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m    = \u001b[38;5;37m\"config-delivery-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "    Purpose = \"aws-config\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m = \u001b[38;5;37m\"aws-config\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "    Account = var.account_name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mAccount\u001b[0m = \u001b[38;5;33mvar\u001b[0m.account_name",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "modules/security-baseline-guardduty",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 1,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "modules/security-baseline-securityhub",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 1,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "modules/waf/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 1,
        "Failures": 0,
        "Exceptions": 0
      }
    }
  ]
}
